# Converted from Documento Final v8_ Estructura de Base de Datos (c.._.docx

Documento Final: Estructura de la Base de Datos
Sistema de Gestión Integral para la Liga Villetana de Fútbol
Versión: 8.0 (Final - Incluye Métodos de Pago Flexibles) Fecha: 7 de Junio de 2025 SGBD de Referencia: PostgreSQL
Introducción
Este documento describe la estructura detallada y final de la base de datos. Esta versión incorpora la flexibilidad necesaria en el Módulo Financiero y de Boletería para registrar múltiples métodos de pago, incluyendo efectivo, tarjeta, transferencia y Pagos QR, adaptándose a las necesidades operativas actuales.
(Los Módulos 1, 2, 3, 6, 7 y 8 y sus tablas se mantienen como en la versión 7, sin cambios. Las adiciones se centran en los Módulos 4 y 5).
MÓDULO 4: GESTIÓN FINANCIERA
Tablas para la administración de ingresos de la liga, como inscripciones y multas.
Tabla: Conceptos_Cobro
Descripción: Tipos de cargos financieros que la liga puede aplicar. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | concepto_id | SERIAL | PK | | | descripcion_concepto | VARCHAR(255) | NOT NULL, UNIQUE| Ej: "Inscripción Torneo Principal", "Tarjeta Amarilla", "Multa por WO". | | monto_sugerido | DECIMAL(12, 2)| NOT NULL, DEFAULT 0| | | tipo_concepto | VARCHAR(50) | | Ej: "INSCRIPCION", "TARJETA", "MULTA". |
Tabla: Cargos_Club
Descripción: Registra una deuda específica de un club con la liga. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | cargo_id | SERIAL | PK | | | club_id | INT | FK a Clubes(club_id) | | | concepto_id | INT | FK a Conceptos_Cobro(concepto_id) | | | evento_id | INT | FK a Eventos_Partido(evento_id), NULLABLE | Si el cargo se originó por un evento (ej. tarjeta). | | monto_cargo | DECIMAL(12, 2)| NOT NULL| | | fecha_cargo | DATE | DEFAULT CURRENT_DATE| | | estado_cargo | VARCHAR(50)| NOT NULL, DEFAULT 'Pendiente' | Ej: "Pagado", "Anulado". |
Tabla: Pagos_Recibidos (NUEVA)
Descripción: Registra cada pago recibido por la Liga (para inscripciones, multas, etc.), detallando el método. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | pago_id | SERIAL | PK | | | club_id | INT | FK a Clubes(club_id), NULLABLE | Club que realiza el pago. | | monto_total_pago | DECIMAL(12, 2)| NOT NULL | | | metodo_pago | VARCHAR(50) | NOT NULL | 'Efectivo', 'Tarjeta (POS)', 'Transferencia Bancaria', 'Pago QR', 'Otro'. | | referencia_pago | VARCHAR(255)| NULLABLE | Nro. de transacción, cheque, nombre del pagador, etc. | | fecha_pago | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | | | usuario_receptor_id| INT | FK a Usuarios(usuario_id) | Usuario del sistema que registró el pago. | | observaciones | TEXT | | Notas adicionales sobre el pago. |
Tabla: Pagos_Cargos_Aplicados (Tabla de Unión)
Descripción: Vincula un pago recibido a uno o más cargos específicos de un club. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | pago_id | INT | PK, FK a Pagos_Recibidos(pago_id)| | | cargo_id | INT | PK, FK a Cargos_Club(cargo_id) | | | monto_aplicado | DECIMAL(12, 2)| NOT NULL | Monto de este pago que se aplica a este cargo específico. |
MÓDULO 5: ENTRADAS Y BOLETERÍAS
Módulo para la gestión de la venta de tickets para los partidos.
Tabla: Precios_Entradas_Fase
Descripción: Define los precios de las entradas según la fase del torneo. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | precio_entrada_fase_id| SERIAL | PK | | | fase_id | INT | FK a Fases_Torneo(fase_id) | | | descripcion_tipo_entrada| VARCHAR(100)| NOT NULL | Ej: "General", "Preferencia", "Socio". | | precio | DECIMAL(12, 2)| NOT NULL | | | activo | BOOLEAN | DEFAULT TRUE | |
Tabla: Ventas_Entradas
Descripción: Registra cada transacción de venta de entradas, incluyendo el método de pago. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | venta_id | SERIAL | PK | Identificador de la transacción de venta. | | partido_id | INT | FK a Partidos(partido_id) | | | usuario_boleteria_id| INT | FK a Usuarios(usuario_id) | Usuario que realizó la venta. | | monto_total_venta | DECIMAL(12, 2)| NOT NULL | | | metodo_pago | VARCHAR(50) | NOT NULL | 'Efectivo', 'Tarjeta (POS)', 'Transferencia Bancaria', 'Pago QR', 'Otro'. | | referencia_pago | VARCHAR(255)| NULLABLE | Nro. de transacción (si aplica). | | fecha_hora_venta | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP| | | punto_venta_id | VARCHAR(100)| | Identificador de la boletería o "ONLINE". | | anulada | BOOLEAN | DEFAULT FALSE | |
Tabla: Boletas_Vendidas
Descripción: Registra cada boleta individual generada en una venta, con su propio identificador único para impresión. | Nombre del Campo | Tipo de Dato (PostgreSQL) | Restricciones | Descripción | | :--- | :--- | :--- | :--- | | boleta_id | SERIAL | PK | | | boleta_uuid | UUID | NOT NULL, UNIQUE, DEFAULT gen_random_uuid()| Identificador Único Universal para el QR de la boleta. | | venta_id | INT | FK a Ventas_Entradas(venta_id)| Transacción a la que pertenece. | | precio_entrada_fase_id | INT | FK a Precios_Entradas_Fase(precio_entrada_fase_id)| Tipo de entrada (General, Menores, etc.). | | precio_pagado | DECIMAL(12, 2) | NOT NULL | Precio de esta boleta específica. | | estado_acceso | VARCHAR(50) | NOT NULL, DEFAULT 'No Utilizada' | 'No Utilizada', 'Utilizada' (para control de acceso). | | fecha_hora_acceso | TIMESTAMP | NULLABLE | Momento exacto en que se usó para ingresar. |
Con estas adiciones, el sistema tiene la flexibilidad necesaria para registrar las transacciones financieras tal como ocurren en la realidad, lo que es vital para una correcta administración y contabilidad por parte de la Liga.